<div id="admin-panel" style="display:none;">
    
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo">⚡ <span data-i18n="admin_panel">管理後台</span></div>
            <div id="sidebar-user-info" style="font-size:0.9rem; color:var(--text-sub);">Admin</div>
        </div>
        <nav class="sidebar-nav">
            <button class="nav-btn active" data-target="section-live"><span class="nav-icon">🎮</span> <span data-i18n="nav_live">現場控台</span></button>
            <button class="nav-btn" data-target="section-stats"><span class="nav-icon">📈</span> <span data-i18n="nav_stats">數據報表</span></button>
            <button class="nav-btn" data-target="section-settings"><span class="nav-icon">⚙️</span> <span data-i18n="nav_settings">系統設定</span></button>
            <button class="nav-btn" data-target="section-line"><span class="nav-icon">💬</span> <span data-i18n="nav_line">LINE設定</span></button>
        </nav>
        <div class="sidebar-footer">
            <div style="display:flex; gap:10px; margin-bottom:10px;">
                <button id="admin-theme-toggle" class="btn-secondary" style="flex:1;">🌙</button>
                <select id="admin-lang-selector" class="lang-select" style="flex:2;"><option value="zh-TW">繁體中文</option><option value="en">English</option></select>
            </div>
            <button id="btn-logout" class="btn-reset-single" style="border:none; color:var(--danger);" data-i18n="logout">登出</button>
        </div>
    </aside>

    <main class="content-area">
        <div id="section-live" class="section-group active">
            <div class="dashboard-header">
                <div class="dashboard-item main-stat">
                    <span class="label" data-i18n="dash_curr">目前叫號</span>
                    <span class="value big-number" id="number">0</span>
                </div>
                <div class="dashboard-item">
                    <span class="label" data-i18n="dash_issued">已發號至</span>
                    <span class="value sub-number" id="issued-number">0</span>
                </div>
                <div class="dashboard-item">
                    <span class="label" data-i18n="dash_wait">等待組數</span>
                    <span class="value sub-number" id="waiting-count" style="color:var(--warning);">0</span>
                </div>
            </div>

            <div class="card-container">
                <div class="card-wrapper">
                    <div class="admin-card control-deck">
                        <h3><span class="card-icon">📢</span> <span data-i18n="card_call">指揮中心</span></h3>
                        <div class="hero-control-row">
                             <button id="btn-call-next" class="btn-hero" data-i18n="btn_next">下一號 ▶</button>
                        </div>
                        <div class="secondary-actions-row">
                            <button id="btn-call-prev" class="btn-secondary" data-i18n="btn_prev">◀ 上一號</button>
                            <button id="btn-mark-passed" class="btn-warn" data-i18n="btn_pass">過號</button>
                        </div>
                        <div class="control-group compact-group">
                            <label data-i18n="lbl_assign">指定 / 插隊</label>
                            <div class="input-group">
                                <div class="quick-actions">
                                    <button class="btn-secondary" id="btn-call-add-1">+1</button>
                                    <button class="btn-secondary" id="btn-call-add-5">+5</button>
                                </div>
                                <input type="number" id="manualNumber" placeholder="#" inputmode="numeric" pattern="\d*" min="0">
                                <button id="setNumber" class="btn-secondary success" data-i18n="btn_exec">GO</button>
                            </div>
                        </div>
                        <button id="resetNumber" class="btn-reset-single" data-i18n="btn_reset_call">↺ 重置叫號</button>
                    </div>
                </div>

                <div class="card-wrapper">
                    <div class="admin-card">
                        <h3><span class="card-icon">🎟️</span> <span data-i18n="card_issue">發號管理</span></h3>
                        <div class="big-action-row">
                            <button id="btn-issue-prev" class="btn-secondary btn-big" data-i18n="btn_recall">➖ 收回</button>
                            <button id="btn-issue-next" class="btn-secondary success btn-big" data-i18n="btn_issue">發號 ➕</button>
                        </div>
                        <div class="control-group" style="margin-top:auto;">
                            <label data-i18n="lbl_fix_issue">修正發號數</label>
                            <div class="input-group">
                                <input type="number" id="manualIssuedNumber" placeholder="#" inputmode="numeric" min="0">
                                <button id="setIssuedNumber" class="btn-secondary" data-i18n="btn_fix">修正</button>
                            </div>
                        </div>
                        <button id="resetIssued" class="btn-reset-single" data-i18n="btn_reset_issue">↺ 重置發號</button>
                    </div>
                </div>

                <div class="card-wrapper">
                    <div class="admin-card">
                        <h3><span class="card-icon">📝</span> <span data-i18n="card_passed">過號名單</span></h3>
                        <div class="list-container">
                            <ul id="passed-list-ui" class="scroll-list"></ul>
                        </div>
                        <div class="control-group compact-group">
                            <label class="add-label">手動加入過號</label>
                            <div class="input-group">
                                <input type="number" id="new-passed-number" placeholder="號碼 (例如 5)" inputmode="numeric" min="0">
                                <button id="add-passed-btn" class="btn-add">+</button>
                            </div>
                        </div>
                        <button id="resetPassed" class="btn-reset-single" data-i18n="btn_clear_passed">清空過號</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="section-stats" class="section-group">
            <div class="card-container">
                <div class="card-wrapper full-width-card">
                    <div class="admin-card">
                        <h3><span class="card-icon">📊</span> <span data-i18n="card_stats">流量分析</span></h3>
                        <div class="dashboard-header" style="margin-bottom:10px; grid-template-columns: 1fr auto;">
                            <div>
                                <p style="margin:0; color:var(--text-sub); font-size:0.8rem;" data-i18n="lbl_today">今日人次</p>
                                <span id="stats-today-count" style="font-size:2.5rem; font-weight:800; color:var(--primary);">0</span>
                            </div>
                            <div class="quick-actions">
                                <button id="btn-refresh-stats" class="btn-secondary" data-i18n="btn_refresh">重整</button>
                                <button id="btn-export-csv" class="btn-secondary success" style="display:none;">CSV</button>
                            </div>
                        </div>
                        <div id="hourly-chart" class="chart-container"><p style="margin:auto; color:var(--text-sub);">Loading...</p></div>
                        <button id="btn-clear-stats" class="btn-reset-single" style="margin-top:15px;" data-i18n="btn_clear_stats">🗑️ 清空統計</button>
                    </div>
                </div>
                
                <div class="card-wrapper full-width-card">
                    <div class="admin-card">
                        <h3><span class="card-icon">📋</span> <span data-i18n="card_logs">操作日誌</span></h3>
                        <div class="list-container">
                            <ul id="admin-log-ui" class="log-list"><li>Wait...</li></ul>
                        </div>
                        <button id="btn-clear-logs" class="btn-reset-single" data-i18n="btn_clear_logs">清除日誌</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="section-settings" class="section-group">
            <div class="card-container">
                <div class="card-wrapper">
                    <div class="admin-card" id="card-sys">
                        <h3><span class="card-icon">⚙️</span> <span data-i18n="card_sys">系統</span></h3>
                        <div class="settings-grid">
                            <label class="setting-card">
                                <span class="setting-label" data-i18n="lbl_public">開放前台</span>
                                <input type="checkbox" id="public-toggle" class="toggle-switch" checked>
                            </label>
                            <label class="setting-card">
                                <span class="setting-label" data-i18n="lbl_sound">提示音效</span>
                                <input type="checkbox" id="sound-toggle" class="toggle-switch">
                            </label>
                        </div>
                        <div class="control-group">
                            <label data-i18n="lbl_tts">TTS 語音廣播</label>
                            <div class="input-group">
                                <input type="text" id="broadcast-msg" placeholder="輸入內容...">
                                <button id="btn-broadcast" class="btn-secondary" data-i18n="btn_play">播放</button>
                            </div>
                        </div>
                        <div id="mode-switcher-group" class="control-group" style="display:none;">
                            <label data-i18n="lbl_mode">取號模式</label>
                            <div style="display:flex; gap:10px;">
                                <label><input type="radio" name="systemMode" value="ticketing" checked> <span data-i18n="mode_online">線上取號</span></label>
                                <label><input type="radio" name="systemMode" value="input"> <span data-i18n="mode_manual">手動輸入</span></label>
                            </div>
                        </div>
                        <button id="resetAll" class="btn-reset-single" style="color:var(--danger);" data-i18n="btn_reset_all">💥 全域重置</button>
                        
                        <div class="mobile-only-settings">
                            <div class="control-group" style="display:flex; gap:10px;">
                                <button id="admin-theme-toggle-mobile" class="btn-secondary" style="flex:1;">🌙 Theme</button>
                                <select id="admin-lang-selector-mobile" class="lang-select" style="flex:2;"><option value="zh-TW">繁體中文</option><option value="en">English</option></select>
                            </div>
                            <button id="btn-logout-mobile" class="btn-reset-single" style="color:var(--danger); margin-top:10px;" data-i18n="logout">登出</button>
                        </div>
                    </div>
                </div>

                <div class="card-wrapper" id="card-booking-merged">
                    <div class="admin-card">
                        <h3><span class="card-icon">📅</span> <span data-i18n="card_booking">預約管理</span></h3>
                        <p style="color:var(--text-sub); margin-bottom:10px; font-size:0.85rem;">叫號時自動優先處理到期預約</p>
                        <div class="list-container" style="height: 200px;">
                            <ul id="appointment-list-ui" class="scroll-list">
                                <li style="text-align:center; padding:20px; color:var(--text-sub);">Loading...</li>
                            </ul>
                        </div>
                        <div class="control-group compact-group" style="margin-top:auto;">
                            <label data-i18n="lbl_add_appt">新增預約</label>
                            <div class="input-group">
                                <input type="number" id="appt-number" placeholder="號碼" style="flex:0.5;">
                                <input type="text" id="appt-time" placeholder="時間" style="flex:1; background-color: var(--bg-body);">
                                <button id="btn-add-appt" class="btn-add">+</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card-wrapper">
                    <div class="admin-card">
                        <h3><span class="card-icon">🔗</span> <span data-i18n="card_links">連結管理</span></h3>
                        <div class="list-container">
                            <ul id="featured-list-ui" class="scroll-list"></ul>
                        </div>
                        <div class="control-group compact-group" style="margin-top:auto;">
                            <label>新增連結</label>
                            <div class="input-group">
                                <input type="text" id="new-link-text" data-i18n-ph="ph_link_name" placeholder="名稱" style="flex:1;">
                            </div>
                            <div class="input-group" style="margin-top:4px;">
                                <input type="text" id="new-link-url" placeholder="URL" style="flex:1;">
                                <button id="add-featured-btn" class="btn-add">+</button>
                            </div>
                        </div>
                        <button id="resetFeaturedContents" class="btn-reset-single" data-i18n="btn_clear_links">清空連結</button>
                    </div>
                </div>

                <div class="card-wrapper">
                    <div class="admin-card">
                        <h3><span class="card-icon">🟢</span> <span data-i18n="card_online">在線管理</span></h3>
                        <div class="list-container">
                            <ul id="online-users-list" class="scroll-list"><li>Loading...</li></ul>
                        </div>
                    </div>
                </div>

                <div class="card-wrapper" id="card-user-management" style="display:none;">
                    <div class="admin-card">
                        <h3><span class="card-icon">👥</span> <span data-i18n="card_users">帳號管理</span></h3>
                        <div class="list-container">
                            <ul id="user-list-ui" class="scroll-list"></ul>
                        </div>
                        <div class="control-group compact-group" style="margin-top:auto;">
                            <label data-i18n="lbl_add_user">新增帳號</label>
                            <div class="input-group">
                                <input type="text" id="new-user-username" placeholder="帳號">
                                <input type="text" id="new-user-password" placeholder="密碼">
                            </div>
                            <div class="input-group" style="margin-top:4px;">
                                <input type="text" id="new-user-nickname" placeholder="暱稱">
                                <select id="new-user-role" style="width: auto;">
                                    <option value="VIEWER">View</option>
                                    <option value="OPERATOR" selected>Op</option>
                                    <option value="MANAGER">Mgr</option>
                                    <option value="ADMIN">Adm</option>
                                </select>
                                <button id="add-user-btn" class="btn-add">+</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card-wrapper full-width-card" id="card-role-management" style="display:none;">
                    <div class="admin-card">
                        <h3><span class="card-icon">🛡️</span> <span data-i18n="card_roles">權限設定</span></h3>
                        <div id="role-editor-content">Loading...</div>
                        <button id="btn-save-roles" class="btn-secondary success" style="width:100%; margin-top:16px;" data-i18n="btn_save_roles">儲存權限變更</button>
                    </div>
                </div>
            </div>
        </div>

        <div id="section-line" class="section-group">
            <div class="card-container">
                <div class="card-wrapper full-width-card">
                    <div class="admin-card">
                        <h3><span class="card-icon">💬</span> LINE 設定</h3>
                        <div class="control-group" id="unlock-pwd-group" style="display:none;">
                            <label>後台安全鎖</label>
                            <div class="input-group">
                                <input type="text" id="line-unlock-pwd" placeholder="設定 Line 解鎖密碼...">
                                <button id="btn-save-unlock-pwd" class="btn-secondary">儲存</button>
                            </div>
                        </div>
                        <div class="list-container" style="min-height:300px;">
                            <ul id="line-settings-list-ui" class="scroll-list"><li>Loading settings...</li></ul>
                        </div>
                        <button id="btn-reset-line-msg" class="btn-reset-single" data-i18n="btn_restore">恢復預設值</button>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>
